ComboSource6301 Configuration Guide
====================================

This file explains how to add the ComboSource 6301 to your VisaIF configuration file.

CONFIGURATION FILE LOCATION:
----------------------------
The VisaIF class looks for configuration files in:
  Matlab/Modules/VisaIF/ConfigFiles/

You can either:
1. Add to existing config file (e.g., AllDevices.csv)
2. Create new config file (e.g., ComboSource6301_Devices.csv)

FILE FORMAT:
------------
CSV format with columns:
instrument, vendor, product, resourceID, interfaceType, serialNumber, devicename

EXAMPLE ENTRIES:
----------------

For USB Connection:
ComboSource6301,Generic,ComboSource6301,USB0::0x1234::0x5678::SN12345::INSTR,visa-usb,,combosource

For RS-232/Serial Connection:
ComboSource6301,Generic,ComboSource6301,COM3,visa-serial,,combosource

For TCPIP Connection:
ComboSource6301,Generic,ComboSource6301,192.168.1.100,visa-tcpip,,combosource


FIELD DESCRIPTIONS:
-------------------
instrument     : ComboSource6301 (class name)
vendor         : Manufacturer name (e.g., "Generic" or actual vendor)
product        : Product name (ComboSource6301)
resourceID     : VISA resource string or COM port
                 - For USB: USB0::VendorID::ProductID::SerialNumber::INSTR
                 - For Serial: COM3 (or COM port number)
                 - For TCPIP: IP address (e.g., 192.168.1.100)
interfaceType  : visa-usb, visa-serial, or visa-tcpip
serialNumber   : Leave empty (or add device serial number)
devicename     : Friendly name used in MATLAB (e.g., "combosource")


HOW TO FIND YOUR DEVICE:
-------------------------

1. Find USB Device:
   In MATLAB, run:
   >> VisaIF.listAvailableVisaUsbDevices
   
   This will show connected USB-TMC devices with their VISA resource strings.

2. Find Serial Port:
   In MATLAB, run:
   >> serialportlist
   
   Or check Windows Device Manager -> Ports (COM & LPT)

3. Find TCPIP Device:
   Check your laser controller's network settings for its IP address.


COMPLETE EXAMPLE CONFIG FILE:
------------------------------
Create a file: Matlab/Modules/VisaIF/ConfigFiles/ComboSource6301_Devices.csv

Contents:
---------
instrument,vendor,product,resourceID,interfaceType,serialNumber,devicename
ComboSource6301,Generic,ComboSource6301,COM3,visa-serial,,combosource
ComboSource6301,Generic,ComboSource6301,USB0::0x1234::0x5678::SN12345::INSTR,visa-usb,,combosource_usb


USAGE IN MATLAB:
----------------
After configuring, use the device name in your code:

% Using default interface (first found)
myLaser = ComboSource6301('combosource');

% Specifying interface type
myLaser = ComboSource6301('combosource', 'visa-serial');

% With message display setting
myLaser = ComboSource6301('combosource', 'visa-serial', 'few');


VERIFICATION:
-------------
To verify your configuration:

1. List all configured devices:
   >> VisaIF.listContentOfConfigFiles

2. Look for "ComboSource6301" entries

3. Try to connect:
   >> myLaser = ComboSource6301('combosource');
   >> disp(myLaser.getID());
   >> myLaser.delete;


TROUBLESHOOTING:
----------------
If connection fails:

1. Check NI-VISA is installed
   - Download from National Instruments website
   - Version 21.5 or newer recommended

2. Verify COM port / USB connection
   - Check Windows Device Manager
   - Verify cable connections
   - Check device power

3. Test with NI MAX (Measurement & Automation Explorer)
   - Open NI MAX
   - Find your device under "Devices and Interfaces"
   - Try "Open VISA Test Panel"
   - Send test command: *IDN?

4. Check MATLAB Toolbox
   - Verify Instrument Control Toolbox is installed
   - Check version: ver('instrument')

5. Verify configuration file
   - Check file exists in correct location
   - Verify CSV format (commas, no extra spaces)
   - Check device name matches exactly


SCPI COMMANDS USED:
-------------------
The ComboSource6301 class uses standard SCPI commands:

Device Info:
  *IDN?              - Identification query
  *RST               - Reset device
  *CLS               - Clear status
  *STB?              - Status byte query
  SYST:ERR?          - Error query

Output Control:
  OUTP ON            - Enable output
  OUTP OFF           - Disable output
  OUTP?              - Query output state

Current Control:
  SOUR:CURR <value>  - Set current (A)
  SOUR:CURR?         - Query current setpoint
  MEAS:CURR?         - Measure current
  SOUR:CURR:LIM <value> - Set current limit
  SOUR:CURR:LIM?     - Query current limit

Power Control:
  SOUR:POW <value>   - Set power (W)
  SOUR:POW?          - Query power setpoint
  MEAS:POW?          - Measure power
  SOUR:POW:LIM <value> - Set power limit
  SOUR:POW:LIM?      - Query power limit

Temperature:
  MEAS:TEMP?         - Measure temperature
  MEAS:TEC:CURR?     - Measure TEC current
  SOUR:TEMP:LIM:LOW <value> - Set min temp limit
  SOUR:TEMP:LIM:LOW? - Query min temp limit
  SOUR:TEMP:LIM:HIGH <value> - Set max temp limit
  SOUR:TEMP:LIM:HIGH? - Query max temp limit

Operating Mode:
  SOUR:FUNC:MODE CURR - Set constant current mode
  SOUR:FUNC:MODE POW  - Set constant power mode
  SOUR:FUNC:MODE?     - Query mode

System:
  SYST:LOCK ON       - Lock front panel
  SYST:LOCK OFF      - Unlock front panel
  SYST:INTL?         - Query interlock status
  SYST:TEMP:PROT?    - Query over-temperature

Note: If your device uses different SCPI commands, you may need to modify
the ComboSource6301.m file accordingly.


SUPPORT:
--------
For additional help:
- See ComboSource6301.doc for full HTML documentation
- Run example: Howto_control_ComboSource6301.m
- Contact: HTW Dresden, Faculty of Electrical Engineering
